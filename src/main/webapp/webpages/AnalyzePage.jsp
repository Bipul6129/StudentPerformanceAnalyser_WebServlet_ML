<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
	<%@ include file="reusable_comp/ImportHeaders.jsp" %>
	<link rel="stylesheet" href="js/leaflet/leaflet.css"/>
	<script src="js/leaflet/leaflet.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.css"/>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/0.4.2/leaflet.draw.js"></script>
	<style>
		label{
			font-size:24px;
			width:100%;
		}
		.carpet{
			
		}
		#ethnicSelect{
			text-align:center;
			
		}
		.selectCard{
			height:230px;
			background-color:#edd5a1;
		}
		.selectOption{
			margin-top:16px;
			font-size:18px;
			background-color:white;
		}
		.selectedOption{
			margin-bottom:24px;
		}
		
		.selected{
			background-color:lightgreen
		}
		#resultSection{
			background-color:#cc9ded;
			width:80%;
			height:140px;
			border-radius:8px;
			display:flex;
			align-items:center;
			justify-content:center;
			font-size:24px;
			color:4c355c;
			padding:32px;
		}
	</style>

</head>
<body>
	<%@ include file="reusable_comp/CheckLogin.jsp" %>
	<%@ include file="reusable_comp/NavBar.jsp" %>
	<div class="center_div">
		<h2>Analyze Page</h2>
		<div class="carpet">
			<div id="map" style="height:400px;width:64%">
			
			</div>
			<div class="card">
				<label id="ethnicSelect" class="selectedOption">Select Ethnicity</label>
				<label id="ageSelect" class="selectedOption">Select Age</label>
				<label id="genderSelect" class="selectedOption">Select Gender</label>
				<label id="statusSelect" class="selectedOption">Select Status</label>
				
			</div>
			
		</div>
		<div class="carpet" style="background-color:#67B6E2">
			<div class="card selectCard">
				<label >Age</label>
				<label class="selectAge selectOption"><18</label>
				<label class="selectAge selectOption">>18<25</label>
				<label class="selectAge selectOption">>25</label>
			</div>
			<div class="card selectCard">
				<label >Gender</label>
				<label class="selectGender selectOption">Male</label>
				<label class="selectGender selectOption">Female</label>
				<label class="selectGender selectOption">Other</label>
			</div>
			<div class="card selectCard">
				<label >Status</label>
				<label class="selectStatus selectOption" style="">Rich</label>
				<label class="selectStatus selectOption" >Middle</label>
				<label class="selectStatus selectOption" >Poor</label>
			</div>
		</div>
		<div id="resultSection">
			Result is presented here
		</div>
		<button id="analyzeBtn">Analyze</button>
		
	</div>
	
	
	
	
	<script>
		$(document).ready(function(){
			var selectEth = false;
			var selectAge = false;
			var selectGender = false;
			var selectStatus = false;
			
			$('.selectStatus').on('click',function(){
				$('.selectStatus').removeClass('selected');
				$('#statusSelect').empty();
				$('#statusSelect').append($(this).text());
				$(this).addClass('selected');
				selectStatus=true;
			});
			
			$('.selectGender').on('click',function(){
				$('.selectGender').removeClass('selected');
				$('#genderSelect').empty();
				$('#genderSelect').append($(this).text());
				$(this).addClass('selected');
				selectGender=true;
			});
			
			$('.selectAge').on('click',function(){
				$('.selectAge').removeClass('selected');
				$('#ageSelect').empty();
				$('#ageSelect').append($(this).text());
				$(this).addClass('selected');
				selectAge=true;
			});
			
			
			
			
			var map = L.map('map',{
				center:[28.4,804.34],
				zoom:7.4,
				zoomControl:false,
				dragging:true,
				minZoom:7,
				attributionControl:false,
				maxBounds: L.latLngBounds(
				        L.latLng(25.97779895546436, 799.573974609375), // Southwestern corner of the allowed bounds
				        L.latLng(30.751277776257812,809.088134765625)    // Northeastern corner of the allowed bounds
				      )
			});
			

			
			var Stadia_OSMBright = L.tileLayer('https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.png', {
				maxZoom: 20,
				attribution: '&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'
			}).addTo(map);
			
			var himalayanLatLng=[[30.050076521698735,800.79345703125],[30.050076521698735,800.79345703125],[30.221101852485987,800.9033203125001],[30.221101852485987,800.9033203125001],[30.14512718337613,801.0900878906251],[30.14512718337613,801.0900878906251],[30.012030680358613,801.2219238281251],[30.012030680358613,801.2219238281251],[30.24957724046765,801.3647460937501],[30.24957724046765,801.3647460937501],[30.44867367928756,801.463623046875],[30.44867367928756,801.463623046875],[30.420256142845158,801.7602539062501],[30.420256142845158,801.7602539062501],[30.35391637229704,802.1008300781251],[30.35391637229704,802.1008300781251],[30.107117887092382,802.2106933593751],[30.107117887092382,802.2106933593751],[30.002516938570686,802.4523925781251],[30.002516938570686,802.4523925781251],[29.888280933159265,802.6721191406251],[29.888280933159265,802.6721191406251],[29.716681287231072,802.81494140625],[29.716681287231072,802.81494140625],[29.649868677972304,803.0236816406251],[29.649868677972304,803.0236816406251],[29.53522956294847,803.2983398437501],[29.53522956294847,803.2983398437501],[29.31514119318728,803.4631347656251],[29.31514119318728,803.4631347656251],[29.180941290001776,803.5839843750001],[29.180941290001776,803.5839843750001],[29.31514119318728,803.9355468750001],[29.31514119318728,803.9355468750001],[29.267232865200903,804.166259765625],[29.267232865200903,804.166259765625],[28.98892237190413,804.2431640625001],[28.98892237190413,804.2431640625001],[28.835049972635176,804.3859863281251],[28.835049972635176,804.3859863281251],[28.738763971370293,804.6166992187501],[28.738763971370293,804.6166992187501],[28.613459424004414,804.7924804687501],[28.613459424004414,804.7924804687501],[28.671310915880834,805.0671386718751],[28.671310915880834,805.0671386718751],[28.526622418648127,805.177001953125],[28.526622418648127,805.177001953125],[28.362401735238237,805.1330566406251],[28.362401735238237,805.1330566406251],[28.323724553546015,805.4626464843751],[28.323724553546015,805.4626464843751],[28.38173504322311,805.682373046875],[28.38173504322311,805.682373046875],[28.159189634046733,805.8251953125001],[28.159189634046733,805.8251953125001],[27.965294915211132,806.0009765625001],[27.965294915211132,806.0009765625001],[28.12043868710109,806.1657714843751],[28.12043868710109,806.1657714843751],[27.9361805667694,806.363525390625],[27.9361805667694,806.363525390625],[28.091366281406945,806.6821289062501],[28.091366281406945,806.6821289062501],[28.004101830368654,806.90185546875],[28.004101830368654,806.90185546875],[27.907058371121995,807.1435546875001],[27.907058371121995,807.1435546875001],[27.839076094777816,807.4621582031251],[27.839076094777816,807.4621582031251],[27.809927780908378,807.725830078125],[27.809927780908378,807.725830078125],[27.97499795326776,807.8686523437501],[27.97499795326776,807.8686523437501],[27.89734922968426,808.08837890625],[27.89734922968426,808.08837890625],[27.712710260887476,808.1652832031251],[27.712710260887476,808.1652832031251],[27.49852672279832,808.0444335937501],[27.49852672279832,808.0444335937501],[27.488781168937997,807.6928710937501],[27.488781168937997,807.6928710937501],[27.61540601339959,806.9238281250001],[27.61540601339959,806.9238281250001],[27.829360859789794,805.8142089843751],[27.829360859789794,805.8142089843751],[28.19792655722615,804.6166992187501],[28.19792655722615,804.6166992187501],[28.815799886487298,803.1884765625001],[28.815799886487298,803.1884765625001],[29.621221113784504,802.4194335937501],[29.621221113784504,802.4194335937501],[29.964452850852005,801.7163085937501],[29.964452850852005,801.7163085937501],[29.84064389983441,801.27685546875],[29.84064389983441,801.27685546875],[30.03105542654023,800.771484375]];
			var himalayanPoly = L.polygon(himalayanLatLng,{color:'blue'}).addTo(map);
			
			var hillyLatLng = [[29.046565622728846,800.6781005859376],[29.046565622728846,800.6781005859376],[28.99372720461893,801.0845947265626],[28.99372720461893,801.0845947265626],[28.714678586706,801.5460205078126],[28.714678586706,801.5460205078126],[28.401064827220896,801.7877197265625],[28.401064827220896,801.7877197265625],[28.164032516628076,802.3809814453126],[28.164032516628076,802.3809814453126],[27.819644755099446,802.8533935546876],[27.819644755099446,802.8533935546876],[27.72243591897343,803.1774902343751],[27.72243591897343,803.1774902343751],[27.790491224830877,803.6389160156251],[27.790491224830877,803.6389160156251],[27.824502916144823,804.0728759765626],[27.824502916144823,804.0728759765626],[27.595934774495056,804.4848632812501],[27.595934774495056,804.4848632812501],[27.396155415336334,804.9847412109376],[27.396155415336334,804.9847412109376],[27.23021032948519,805.5450439453125],[27.23021032948519,805.5450439453125],[27.23021032948519,806.2536621093751],[27.23021032948519,806.2536621093751],[26.892679095908164,806.4294433593751],[26.892679095908164,806.4294433593751],[26.848578525873304,806.9732666015626],[26.848578525873304,806.9732666015626],[26.740704807127834,807.6104736328126],[26.740704807127834,807.6104736328126],[26.740704807127834,807.9785156250001],[26.740704807127834,807.9785156250001],[26.8730809659384,808.1542968750001],[26.8730809659384,808.1542968750001],[27.07380043091176,808.0334472656251],[27.07380043091176,808.0334472656251],[27.205785724383325,808.0004882812501],[27.205785724383325,808.0004882812501],[27.33761490945199,808.0499267578126],[27.33761490945199,808.0499267578126],[27.503399176197842,808.0334472656251],[27.503399176197842,808.0334472656251],[27.49852672279832,807.6873779296876],[27.49852672279832,807.6873779296876],[27.552111841284695,807.2534179687501],[27.552111841284695,807.2534179687501],[27.712710260887476,806.4074707031251],[27.712710260887476,806.4074707031251],[27.98470011861268,805.2758789062501],[27.98470011861268,805.2758789062501],[28.21244928533849,804.5892333984376],[28.21244928533849,804.5892333984376],[28.589345223446188,803.7048339843751],[28.589345223446188,803.7048339843751],[28.825425374477224,803.16650390625],[28.825425374477224,803.16650390625],[29.16175551532885,802.8588867187501],[29.16175551532885,802.8588867187501],[29.511330027309146,802.5238037109376],[29.511330027309146,802.5238037109376],[29.683280533733644,802.320556640625],[29.683280533733644,802.320556640625],[29.888280933159265,801.8756103515626],[29.888280933159265,801.8756103515626],[29.969211659636688,801.7163085937501],[29.969211659636688,801.7163085937501],[29.854937397596718,801.265869140625],[29.854937397596718,801.265869140625],[30.0405664305846,800.7659912109375],[30.0405664305846,800.7659912109375],[29.964452850852005,800.606689453125],[29.964452850852005,800.606689453125],[29.84064389983441,800.5187988281251],[29.84064389983441,800.5187988281251],[29.783449456820605,800.3869628906251],[29.783449456820605,800.3869628906251],[29.434813598289637,800.255126953125],[29.434813598289637,800.255126953125],[29.267232865200903,800.3155517578126],[29.267232865200903,800.3155517578126],[29.128171782816224,800.2496337890625]];
			var hillyPoly = L.polygon(hillyLatLng,{color:'green'}).addTo(map);
			
			var teraiLatLng = [[28.9120147012556,800.0628662109376],[28.9120147012556,800.0628662109376],[29.07057414581467,800.1287841796876],[29.07057414581467,800.1287841796876],[29.142566155107065,800.2001953125001],[29.142566155107065,800.2001953125001],[29.104176683949984,800.3924560546876],[29.104176683949984,800.3924560546876],[29.060971407383914,800.6286621093751],[29.060971407383914,800.6286621093751],[29.017748018496047,800.947265625],[29.017748018496047,800.947265625],[28.98892237190413,801.0736083984376],[28.98892237190413,801.0736083984376],[28.839861937967964,801.3482666015626],[28.839861937967964,801.3482666015626],[28.676130433078256,801.5789794921876],[28.676130433078256,801.5789794921876],[28.401064827220896,801.7822265625],[28.401064827220896,801.7822265625],[28.275358281817105,802.1282958984375],[28.275358281817105,802.1282958984375],[28.168875180063345,802.3699951171876],[28.168875180063345,802.3699951171876],[27.97984914504167,802.628173828125],[27.97984914504167,802.628173828125],[27.843933386070514,802.8424072265626],[27.843933386070514,802.8424072265626],[27.732160709580906,803.2104492187501],[27.732160709580906,803.2104492187501],[27.800209937418252,803.6444091796875],[27.800209937418252,803.6444091796875],[27.834218586009197,804.0783691406251],[27.834218586009197,804.0783691406251],[27.688392321785685,804.3365478515625],[27.688392321785685,804.3365478515625],[27.522886832325796,804.66064453125],[27.522886832325796,804.66064453125],[27.405909155361044,804.9957275390626],[27.405909155361044,804.9957275390626],[27.23997867180821,805.53955078125],[27.23997867180821,805.53955078125],[27.23997867180821,805.9899902343751],[27.23997867180821,805.9899902343751],[27.23997867180821,806.2426757812501],[27.23997867180821,806.2426757812501],[26.917171977972313,806.3964843750001],[26.917171977972313,806.3964843750001],[26.868180902512403,806.8249511718751],[26.868180902512403,806.8249511718751],[26.80446076654616,807.2918701171876],[26.80446076654616,807.2918701171876],[26.740704807127834,807.7642822265626],[26.740704807127834,807.7642822265626],[26.770135082241474,808.0279541015626],[26.770135082241474,808.0279541015626],[26.868180902512403,808.1542968750001],[26.868180902512403,808.1542968750001],[26.54922257769204,808.1213378906251],[26.54922257769204,808.1213378906251],[26.377106813670053,808.0279541015626],[26.377106813670053,808.0279541015626],[26.43122806450644,807.6983642578126],[26.43122806450644,807.6983642578126],[26.406630642556795,807.4951171875001],[26.406630642556795,807.4951171875001],[26.37218544169559,807.3138427734376],[26.37218544169559,807.3138427734376],[26.58852714730864,807.0227050781251],[26.58852714730864,807.0227050781251],[26.475490196773805,806.8304443359376],[26.475490196773805,806.8304443359376],[26.441065564038418,806.7315673828125],[26.441065564038418,806.7315673828125],[26.61799672211676,806.2921142578126],[26.61799672211676,806.2921142578126],[26.598351182358293,806.1932373046875],[26.598351182358293,806.1932373046875],[26.652368294008866,806.0064697265626],[26.652368294008866,806.0064697265626],[26.58852714730864,805.8361816406251],[26.58852714730864,805.8361816406251],[26.745610382199022,805.7208251953126],[26.745610382199022,805.7208251953126],[26.853479438420024,805.6274414062501],[26.853479438420024,805.6274414062501],[26.789751030291114,805.3912353515626],[26.789751030291114,805.3912353515626],[26.775039386999605,805.2154541015626],[26.775039386999605,805.2154541015626],[26.877980817017615,805.1550292968751],[26.877980817017615,805.1550292968751],[26.86328062676624,805.0396728515626],[26.86328062676624,805.0396728515626],[26.96124577052697,804.9353027343751],[26.96124577052697,804.9353027343751],[27.01998400798257,804.6881103515625],[27.01998400798257,804.6881103515625],[27.13736835979561,804.66064453125],[27.13736835979561,804.66064453125],[27.279043466068245,804.6551513671876],[27.279043466068245,804.6551513671876],[27.352252938063845,804.495849609375],[27.352252938063845,804.495849609375],[27.381523191705053,804.2926025390626],[27.381523191705053,804.2926025390626],[27.47416122087989,804.1992187500001],[27.47416122087989,804.1992187500001],[27.518015241965667,804.1003417968751],[27.518015241965667,804.1003417968751],[27.430289738862594,803.9959716796875],[27.430289738862594,803.9959716796875],[27.435165209660347,803.8696289062501],[27.435165209660347,803.8696289062501],[27.366889032381295,803.836669921875],[27.366889032381295,803.836669921875],[27.45466493898314,803.6169433593751],[27.45466493898314,803.6169433593751],[27.47416122087989,803.3862304687501],[27.47416122087989,803.3862304687501],[27.36201054924028,803.3532714843751],[27.36201054924028,803.3532714843751],[27.381523191705053,803.2434082031251],[27.381523191705053,803.2434082031251],[27.459539332717906,803.155517578125],[27.459539332717906,803.155517578125],[27.459539332717906,802.9467773437501],[27.459539332717906,802.9467773437501],[27.518015241965667,802.7325439453126],[27.518015241965667,802.7325439453126],[27.717573198352596,802.6940917968751],[27.717573198352596,802.6940917968751],[27.688392321785685,802.4304199218751],[27.688392321785685,802.4304199218751],[27.88278388425912,802.0898437500001],[27.88278388425912,802.0898437500001],[27.916766641249065,801.9580078125],[27.916766641249065,801.9580078125],[27.858503954841247,801.8701171875001],[27.858503954841247,801.8701171875001],[28.101057958669447,801.4581298828125],[28.101057958669447,801.4581298828125],[28.154346532344004,801.3427734375001],[28.154346532344004,801.3427734375001],[28.352733760237818,801.1944580078126],[28.352733760237818,801.1944580078126],[28.44937385955666,800.9802246093751],[28.44937385955666,800.9802246093751],[28.69058765425071,800.4858398437501],[28.69058765425071,800.4858398437501],[28.555576049185973,800.5133056640626],[28.555576049185973,800.5133056640626],[28.753212537990336,800.1672363281251],[28.753212537990336,800.1672363281251],[28.8975881579445,800.0683593750001]];
			var teraiPoly = L.polygon(teraiLatLng,{color:'red'}).addTo(map);
			
			
			
			himalayanPoly.on('click',function(e){
				
				$('#ethnicSelect').empty();
				$('#ethnicSelect').append('Himalayan');
				selectEth=true;
			})
			
			hillyPoly.on('click',function(e){
				
				$('#ethnicSelect').empty();
				$('#ethnicSelect').append('Hilly');
				selectEth=true;
			})
			
			teraiPoly.on('click',function(e){
				
				$('#ethnicSelect').empty();
				$('#ethnicSelect').append('Terai');
				selectEth=true;
			})
			
			
			$('#analyzeBtn').on('click',function(){
				if(!selectAge||!selectGender||!selectEth||!selectStatus){
					Swal.fire(
							  'Select All Attribute',
							  'Select all attribute to analyze the performance ',
							  'error'
							)
				}else{
					data={
						ethnic:$('#ethnicSelect').text().toLowerCase(),
						age:$('#ageSelect').text().toLowerCase(),
						gender:$('#genderSelect').text().toLowerCase(),
						status:$('#statusSelect').text().toLowerCase(),
					}
					console.log(data);
					$.ajax({
						url:'algoTrigger',
						method:'get',
						data:data,
						success:function(response){
							console.log(response);
							$('#resultSection').empty();
							var ethnic=$('#ethnicSelect').text();
							var age=$('#ageSelect').text();
							var gender=$('#genderSelect').text();
							var status=$('#statusSelect').text();
							var string="The "+gender+" student who's age is "+age+" from "+ethnic+" region with "+status+" family status has performance outcome of "+response.message;
							$('#resultSection').append(string);
						},
						error:function(){
							
						}
					});
				}
				
			})
			
		})
		
		

		
		
		
		
		//Draw tools
		/*
		var drawnItems = new L.FeatureGroup();
	    map.addLayer(drawnItems);
	    var drawControl = new L.Control.Draw({
	    	edit:{
	    		featureGroup:drawnItems,
	    		remove:true
	    	}
	    });
	    map.addControl(drawControl);
	    
	    map.on('draw:created',function(e){
	    	var type = e.layerType;
	    	var layer = e.layer;
	    	console.log(e);
	    	
	    	var coor="";
	    	
	    	for(i=0;i<e.layer._latlngs[0].length;i++){
	    		
	    		coor=coor+'['+e.layer._latlngs[0][i].lat+','+e.layer._latlngs[0][i].lng+'],';
	    		
	    		
	    	}
	    	console.log(coor);
	    	drawnItems.addLayer(layer);
	    });
	     
		*/
		
	</script>
	

</body>
</html>